SELECT o.item_id, sum(o.item_total) as total, count(o.item_total) as transaction, avg(o.item_total) as avg, max(o.item_total) as highest, i.item_name, u.unit_name, i.stok, i.newest_lead_time, n.max_lead_time, n.avg_lead_time FROM item_out_tb o LEFT JOIN items i ON i.id=o.item_id LEFT JOIN units u ON u.id=i.unit_id LEFT JOIN (SELECT item_id, avg(lead_time) as avg_lead_time, max(lead_time) as max_lead_time FROM item_in_tb WHERE lead_time != 0) as n ON n.item_id=o.item_id WHERE o.status = 'accepted' AND o.out_date >= '2022-07-22 00:29:40' AND o.out_date <= '2022-10-20 00:29:40' GROUP BY o.item_id ORDER BY total DESC;